
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1. Network science &#8212; Computational Neuroscience</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=9f7f7efb" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/network_theory/a';</script>
    <script src="../../_static/custom.js?v=1fd2e2ea"></script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="2. Machine Learning" href="../ML/b.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/cajal1.png" class="logo__image only-light" alt="Computational Neuroscience - Home"/>
    <script>document.write(`<img src="../../_static/cajal1.png" class="logo__image only-dark" alt="Computational Neuroscience - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Course overview
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Math review with Python</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mathpython_intro/IntroColab.html">Google’s Colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mathpython_intro/Numpy_Introduction.html">Introduction to NumPy and Matplotlib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mathpython_intro/Linear_Algebra.html">Linear Algebra basics</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 1. Introduction to modeling in neuroscience</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../modelling_intro/week0-Intro-RWB.html">1. What is computational neuroscience?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 2. Differential equations and neuron models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../dynamical_systems/dynamical_systems_intro.html">1. Introduction modelling with differential equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dynamical_systems/Applications_LT.html">2. Dynamical systems as Linear Transformations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 3. Simulating neural populations with Brian</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../simulation_neuralsystems/neuralsimulation_intro.html">1. Simulating neural populations with Brian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation_neuralsystems/a.html">2. Introduction to Brian part 1: Neurons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation_neuralsystems/b.html">3. Introduction to Brian part 2: Synapses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulation_neuralsystems/c.html">4. Introduction to Brian part 3: Simulations</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 4. Data analysis and Machine learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ML/a.html">1. Introduction to Data Analysis with Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ML/b.html">2. Machine Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapter 5. Network theory</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1. Network science</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/BergLab/CompNeuroBook/blob/main/notebooks/network_theory/a.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BergLab/CompNeuroBook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BergLab/CompNeuroBook/edit/main/notebooks/network_theory/a.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BergLab/CompNeuroBook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/network_theory/a.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/network_theory/a.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Network science</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-networks">1.1. Why networks?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-network-concepts">1.2. Basic network concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nodes-and-edges">1.2.1. Nodes and edges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-connectivity">1.2.2. Network Connectivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connected-network">1.2.3. Connected Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#directed-vs-undirected-network">1.2.4. Directed vs undirected network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphs-with-features">1.2.5. Graphs with features</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#features-normalisation">1.2.5.1. Features normalisation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-activation">1.2.5.2. Feature activation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-linear-transformations">1.2.5.3. Extra Linear transformations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-networkx">1.3. Using NetworkX</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">1.3.1. Exercises 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-used-to-characterise-networks">1.4. Measures used to characterise networks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degree-of-connectivity">1.4.1. Degree of connectivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-diameter-and-shortest-path">1.4.2. Distance, diameter and shortest path</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centrality">1.4.3. Centrality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1.4.3.1. Exercises 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-coefficient">1.4.4. Clustering coefficient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cliques">1.4.5. Cliques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motifs-and-motifs-analysis">1.4.6. Motifs and motifs analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">1.4.6.1. Exercise 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scale-free-networks">1.4.7. Scale free networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-world-networks">1.4.8. Small-world networks</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-evaluating-the-small-worldness-of-a-network-g">1.4.8.1. Bonus: Evaluating the small-worldness of a network G</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.4.8.2. Exercise 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#propagation-or-replication-in-a-network">1.4.9. Propagation -or replication- in a network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-in-a-network">1.4.10. Diffusion in a network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-graph-theory">1.4.11. Spectral graph theory</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="network-science">
<h1><span class="section-number">1. </span>Network science<a class="headerlink" href="#network-science" title="Link to this heading">#</a></h1>
<p>Network science is a discipline that deals with systems —made of many elements— and studies how the connectivity of the system affects its observed behavior.
Examples of applications of network science are ecosystems, biological pathways, gene regulatory networks or neural networks.</p>
<section id="why-networks">
<h2><span class="section-number">1.1. </span>Why networks?<a class="headerlink" href="#why-networks" title="Link to this heading">#</a></h2>
<p>One can wonder what’s the point of using network models to describe natural phenomena made of heterogeneous elements connected among them. The reason is that the graph formalism allows us to describe complex phenomena based on its network properties which we can quantified with the quantities we will define below. Here’s some examples of use cases:</p>
<ul class="simple">
<li><p>We want to characterise networks in order to change them so we can improve their behaviour (eg. the network of world’s airport: improve the efficiency of traveling between countries).</p></li>
<li><p>We want to characterise them so we can compare to check if they’re behaving normally, eg. check if  gene regulatory network is behaving normally or there is some malfunctioning or if they’re “real” network, eg. is a given twitter is made of humans or of <em>russian</em> bots.</p></li>
</ul>
<p>In both cases, the healthy —or real— network is used as the null model for testing some <em>malfunction</em> hypothesis.</p>
<p>The so called <strong>Network Neuroscience</strong> is a growing field which uses network methods to study the brain. For instance to build <a class="reference external" href="https://www.frontiersin.org/articles/10.3389/fnsys.2010.00016/full">functional brain networks based on EEG/MEG or fMRI</a> which can be used to characterise healthy vs clinical conditions or <a class="reference external" href="https://n.neurology.org/content/96/5/e758">guide surgical procedures like epilepsy surgery</a>.</p>
<br>
<br>
<div align="center">
<p style="text-align:center;"><img src="https://www.neurology.org/cms/10.1212/WNL.0000000000011315/asset/fb3b4085-04d1-42df-a219-fe20d185d268/assets/graphic/14ff1.jpeg" width="600"/>
</div></section>
<section id="basic-network-concepts">
<h2><span class="section-number">1.2. </span>Basic network concepts<a class="headerlink" href="#basic-network-concepts" title="Link to this heading">#</a></h2>
<section id="nodes-and-edges">
<h3><span class="section-number">1.2.1. </span>Nodes and edges<a class="headerlink" href="#nodes-and-edges" title="Link to this heading">#</a></h3>
<p>A network —or graph— is a set of nodes —or vertices— and the connections between them named links —or edges—. A network size is defined as it number of nodes <span class="math notranslate nohighlight">\(N\)</span>. Two nodes are said to be <strong>adjacent</strong> if they are connected by single edge. Mathematically, it’s usually notated as <span class="math notranslate nohighlight">\(G = (V,E)\)</span>, ie. a graph <span class="math notranslate nohighlight">\(G\)</span> is a set of vertices <span class="math notranslate nohighlight">\(V\)</span> and edges <span class="math notranslate nohighlight">\(E\)</span>.</p>
</section>
<section id="network-connectivity">
<h3><span class="section-number">1.2.2. </span>Network Connectivity<a class="headerlink" href="#network-connectivity" title="Link to this heading">#</a></h3>
<p>The connectivity of network can be given as</p>
<ul class="simple">
<li><p>Adjacency matrix: a square matrix whose values (0 or 1) indicated the presence or not of edge between 2 nodes. It gives the connection configuration of the network. Each row —and each column— represents one node of the network, eg. 1st row encodes the connections of the <em>node 1</em> of the network.</p></li>
<li><p>Connectivity matrix: the same as the adjacency matrix.</p></li>
<li><p>Weight matrix: same idea as the adjacency matrix but now, instead of having zeros and ones, we have real values which represent the strength of the connection.</p></li>
</ul>
<br>
<div align="center">
<p style="text-align:center;"><img src="https://mathworld.wolfram.com/images/eps-svg/AdjacencyMatrix_1002.svg" width="500"/>
</div>
</section>
<section id="connected-network">
<h3><span class="section-number">1.2.3. </span>Connected Network<a class="headerlink" href="#connected-network" title="Link to this heading">#</a></h3>
<p>A network is said to be <strong>connected</strong> if there exist a path between any pairs of nodes in the network. Two networks between which there is not path are said to be <strong>disjoint</strong>.</p>
<p>A network can often be sub-divided in separated clusters, where all nodes within each cluster are directly or indirectly connected, but where no path exist between different clusters. In matrix notation these clusters could be mapped into a matrix A with a <strong>block diagonal matrix</strong> (each block corresponding to a cluster).</p>
</section>
<section id="directed-vs-undirected-network">
<h3><span class="section-number">1.2.4. </span>Directed vs undirected network<a class="headerlink" href="#directed-vs-undirected-network" title="Link to this heading">#</a></h3>
<p>A network is said to be directed if the connections between the node have directionality:</p>
<div align="center">
<p style="text-align:center;"><img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Directed_graph.svg" width="300"/>
</div>
<p>If the network is non-directed the adjacency matrix will be symmetrical.</p>
</section>
<section id="graphs-with-features">
<h3><span class="section-number">1.2.5. </span>Graphs with features<a class="headerlink" href="#graphs-with-features" title="Link to this heading">#</a></h3>
<p>Nodes may contain features, such as activations:</p>
<div align="right">
<!-- <p style="text-align:center;"><img src="../network_theory/media/graphfeatures.png" width="500"/> -->
<p style="text-align:center;"><img src="https://github.com/BergLab/CompNeuroCourse/blob/main/notebooks/network_theory/media/graphfeatures.png?raw=true" width="500"/>
</div>
<p>In this case, we can represent the structure of the graph with the weight / adjacency <span class="math notranslate nohighlight">\(W\)</span> matrix and the features of the nodes with a vector <span class="math notranslate nohighlight">\(F\)</span>. The product <span class="math notranslate nohighlight">\(W F\)</span> represents a new feature vector representing the propagation of the features values across the network, i.e. the feature value of a node will be the sum of the features of its connected nodes weighted by the respective edge values.</p>
<section id="features-normalisation">
<h4><span class="section-number">1.2.5.1. </span>Features normalisation<a class="headerlink" href="#features-normalisation" title="Link to this heading">#</a></h4>
<p>A common practice prevent the explossion of the features of a graph is to normalise by using the <strong>degree matrix</strong> <span class="math notranslate nohighlight">\(D\)</span>: diagonal matrix that contains information about the number of edges attached to each vertex. So we get: <span class="math notranslate nohighlight">\(F_{normalised} = D^{-1} W F\)</span></p>
</section>
<section id="feature-activation">
<h4><span class="section-number">1.2.5.2. </span>Feature activation<a class="headerlink" href="#feature-activation" title="Link to this heading">#</a></h4>
<p>Like in machine learning neural networks, we can apply a non-linearity <span class="math notranslate nohighlight">\(\sigma\)</span> to the output of the feature propagation:</p>
<p><span class="math notranslate nohighlight">\(F^{'} = \sigma(D^{-1} W F )\)</span></p>
</section>
<section id="extra-linear-transformations">
<h4><span class="section-number">1.2.5.3. </span>Extra Linear transformations<a class="headerlink" href="#extra-linear-transformations" title="Link to this heading">#</a></h4>
<p>Extra linear transformations —equivalent to linear layers in ANN— can be addded by simply adding an extra learnable matrix <span class="math notranslate nohighlight">\(L\)</span>. Remeber linar applications are not commutative.</p>
<p><span class="math notranslate nohighlight">\(F^{'} = \sigma(L W D^{-1} F )\)</span></p>
</section>
</section>
</section>
<section id="using-networkx">
<h2><span class="section-number">1.3. </span>Using NetworkX<a class="headerlink" href="#using-networkx" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://networkx.guide/">NetworkX</a> is a Python library for the creation, manipulation, and study of the structure, dynamics, and functions of complex networks. Check <a class="reference external" href="https://networkx.org/documentation/stable/auto_examples/index.html">the gallery</a> to get a sense of what can be done with it.</p>
<p>Let’s start by creating and visualizing a simple graph. Notice that we do not need to create the nodes in order to add edges. When adding a edge between two nodes indices, NetworkX will add the corresponding nodes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">rand</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create graph G</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

<span class="c1"># Add edges —nodes are added when specifying the edges</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>


<span class="c1"># Drawing options</span>
<span class="n">drawing_options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;font_size&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s2">&quot;node_size&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;node_color&quot;</span><span class="p">:</span> <span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="s2">&quot;edgecolors&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
    <span class="s2">&quot;linewidths&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Draw graph G </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">drawing_options</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dc7b68ac50f3ca107b0b58b48018d2a2e7bef3852e68eda5f2d203bb940fcc03.png" src="../../_images/dc7b68ac50f3ca107b0b58b48018d2a2e7bef3852e68eda5f2d203bb940fcc03.png" />
</div>
</div>
<p>Instead of adding the nodes and edges one by one we can use a loop. Let’s create a random graph. Notice that since we’re randomly sampling the edges we may get a disjoint graph.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create graph G</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>

<span class="c1"># Create a random set of edges</span>
<span class="n">maxNumberOfNodes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">numberOfEdges</span> <span class="o">=</span> <span class="mi">20</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numberOfEdges</span><span class="p">):</span>
    <span class="n">edge_from_node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">maxNumberOfNodes</span><span class="p">)</span> <span class="c1"># Sample a random number from [0, maxNumberOfNodes]</span>
    <span class="n">edge_to_node</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">maxNumberOfNodes</span><span class="p">)</span>   <span class="c1"># Sample a random number from [0, maxNumberOfNodes]</span>
    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge_from_node</span><span class="p">,</span> <span class="n">edge_to_node</span><span class="p">)</span>   <span class="c1"># Add the edge between the random values</span>


<span class="c1"># Draw graph G </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">drawing_options</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8a093f5b55c26359675e54bc39bcb342c1b1ccb1854a8bab6fadf1983c144f9d.png" src="../../_images/8a093f5b55c26359675e54bc39bcb342c1b1ccb1854a8bab6fadf1983c144f9d.png" />
</div>
</div>
<p>We can easily obtain the adjacency matrix representation of the graph:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adjacency_matrix</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">to_numpy_array</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0. 1. 1. 0. 0. 1. 0. 1. 0. 0.]
 [1. 1. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 1. 1. 0. 0.]
 [0. 0. 0. 1. 0. 0. 1. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 1. 1. 0. 0. 1. 1. 1.]
 [1. 0. 0. 1. 0. 0. 1. 0. 0. 1.]
 [0. 1. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 1. 0. 1.]]
</pre></div>
</div>
</div>
</div>
<p>We can also define a network by creating a adjacency matrix first and using it to build the graph:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create random network</span>
<span class="n">networkSize</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">adj_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">networkSize</span><span class="p">))</span> <span class="c1"># create a square random matrix with 0s and 1s of of size networkSize</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>

<span class="c1"># Draw network</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">drawing_options</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>

<span class="c1"># Print Adjacency matrix matrix </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adjacency matrix:</span><span class="se">\n\n</span><span class="si">{</span><span class="n">adj_matrix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ecb9712c509700d5f865a8e5a841d0ff961d0f1296cb408673c02a51751830e.png" src="../../_images/9ecb9712c509700d5f865a8e5a841d0ff961d0f1296cb408673c02a51751830e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adjacency matrix:

[[1 1 1 1 0 1 1]
 [0 0 0 1 0 0 0]
 [1 0 0 1 0 1 1]
 [1 1 1 1 1 1 0]
 [1 0 0 0 1 1 0]
 [1 1 0 1 1 0 1]
 [0 0 1 0 0 0 1]]
</pre></div>
</div>
</div>
</div>
<p>If we want to create a sparse network, then we can do so by creating sparse connectivity matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span><span class="p">,</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">default_rng</span>

<span class="n">networkSize</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">minWeight</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">maxWeight</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sparsity</span> <span class="o">=</span> <span class="mf">0.2</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">default_rng</span><span class="p">()</span>
<span class="n">rvs</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">minWeight</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">maxWeight</span> <span class="o">-</span> <span class="n">minWeight</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span>
<span class="n">sparse_adj_matrix</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">networkSize</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="n">sparsity</span><span class="p">,</span> <span class="n">data_rvs</span><span class="o">=</span><span class="n">rvs</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">G_sparse</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">sparse_adj_matrix</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">G_sparse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Graph with 10 nodes and 18 edges
</pre></div>
</div>
</div>
</div>
<p>By default, networkX create graphs as undirected even if the adjacency matrix is not symmetric. To create directed graphs we need to add  <code class="docutils literal notranslate"><span class="pre">create_using=nx.DiGraph</span></code> when creating the graph from the adjacency matrix.</p>
<p>Let’s created a <strong>weighted directed graph</strong> and draw it with the edge colours indicating the weight value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters</span>
<span class="n">networkSize</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">minWeight</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">maxWeight</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Create a random weighted adjacency matrix</span>
<span class="n">adj_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">minWeight</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">maxWeight</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">networkSize</span><span class="p">))</span>

<span class="c1"># Create a directed graph from the adjacency matrix</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">from_numpy_array</span><span class="p">(</span><span class="n">adj_matrix</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">)</span>

<span class="c1"># Create a plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>  <span class="c1"># Get current axes</span>

<span class="c1"># Draw the network</span>
<span class="n">nodes_size</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="n">edge_colors</span> <span class="o">=</span> <span class="n">adj_matrix</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>  <span class="c1"># positions for all nodes</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="n">edge_colors</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s1">&#39;arc3, rad = 0.1&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Create a colorbar</span>
<span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">edge_colors</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">edge_colors</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">sm</span><span class="o">.</span><span class="n">set_array</span><span class="p">([])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Edge Weight&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ba6d39def07b580e4ea075c33268970dd0eb866967d144a7142aab49f267eba2.png" src="../../_images/ba6d39def07b580e4ea075c33268970dd0eb866967d144a7142aab49f267eba2.png" />
</div>
</div>
<section id="exercises">
<h3><span class="section-number">1.3.1. </span>Exercises 🧑‍💻🔨<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Write down the connectivity matrices of the following networks (in paper and as a numpy array):</p></li>
</ul>
<div align="center">
<p style="text-align:center;"><img src="https://github.com/BergLab/CompNeuroCourse/blob/main/notebooks/network_theory/media/graphs.png?raw=true" width="500"/>
</div>
<ul class="simple">
<li><p>Using the connectivity matrices you just wrote, create a graph with NetworkX for each of them and draw them using <code class="docutils literal notranslate"><span class="pre">draw_networkx()</span></code> function.</p></li>
<li><p>How would you would recurrent connections look in the matrix? ie. a nodes that are connected to themselves.</p></li>
<li><p>What phenomena could be described with a directed network? What phenomena could be described with a non-directed network?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="measures-used-to-characterise-networks">
<h2><span class="section-number">1.4. </span>Measures used to characterise networks<a class="headerlink" href="#measures-used-to-characterise-networks" title="Link to this heading">#</a></h2>
<section id="degree-of-connectivity">
<h3><span class="section-number">1.4.1. </span>Degree of connectivity<a class="headerlink" href="#degree-of-connectivity" title="Link to this heading">#</a></h3>
<p>The average degree —or connectivity—, <strong>k</strong> is the average number of edges per node. Usually we work with the average <span class="math notranslate nohighlight">\(&lt;k&gt;\)</span> and the degree distribution which is the probability P(k) that a given node have k links to the remaining N − 1 nodes.</p>
</section>
<section id="distance-diameter-and-shortest-path">
<h3><span class="section-number">1.4.2. </span>Distance, diameter and shortest path<a class="headerlink" href="#distance-diameter-and-shortest-path" title="Link to this heading">#</a></h3>
<p>The <strong>distance</strong> between two nodes in a network is defined as the minimal number of links that connect them.</p>
<p>From the concept of distance, we can define, for a connected network, a <strong>diameter</strong> as the longest of all the calculated shortest paths between any two nodes. An example would be in the networks of the world’s airports, what’s the maximum number of flights you need to take to get to any airport from any airport, similarly, in biological phenomena, there must have been an evolutionary pressure to find optimal pathways for sensory processing.</p>
<p>The <strong>average shortest-path</strong> between any two nodes of a network is a measure of efficiency of information propagation, since you want to be able to any airport as fast as possible.</p>
</section>
<section id="centrality">
<h3><span class="section-number">1.4.3. </span>Centrality<a class="headerlink" href="#centrality" title="Link to this heading">#</a></h3>
<p><strong>Centrality</strong> measures try to rank the importance of the nodes in a network. There exist several ways of defining the centrality of a node, for instance, the <strong>Degree centrality</strong> of a node is its number of links.
Another quantification of a node centrality is <em>betweenness</em>. <strong>Betweenness centrality</strong> measures the number of times a node lies on the shortest path between other nodes. We can compute it for a single node, or for the whole network as the average of all nodes betweness. This help define some nodes as hubs is the have high betweenness. <strong>Closeness centrality</strong> ranks each node based on their closeness to all other nodes in the network, ie. the node with the shortest paths to all other nodes rank higher. Which specific centrality measure is best to use depends on the aspect of the specific network we are studying.</p>
<p>Let’s use NetworkX to compute these quantities of some networks. Let’s start by computing the degrees for every node:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">networkSize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># probability of for a node to be connected to any other node, eg. p=1 all nodes would be connected to each other and p=0 there would not be any edge</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">gnp_random_graph</span><span class="p">(</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="c1"># gnp_random_graph function generates a random graph</span>

<span class="n">degree_nodes</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">degree_nodes</span><span class="p">)</span> <span class="c1"># A list of tuples with first number representing the node index and its degree</span>

<span class="c1"># Let&#39;s print it in a easier to read format</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">degree_nodes</span><span class="p">:</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Node </span><span class="si">{</span><span class="n">node</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> has degree </span><span class="si">{</span><span class="n">node</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(0, 14), (1, 8), (2, 9), (3, 11), (4, 8), (5, 9), (6, 7), (7, 8), (8, 5), (9, 6), (10, 11), (11, 3), (12, 13), (13, 10), (14, 7), (15, 13), (16, 11), (17, 8), (18, 13), (19, 12)]
Node 0 has degree 14
Node 1 has degree 8
Node 2 has degree 9
Node 3 has degree 11
Node 4 has degree 8
Node 5 has degree 9
Node 6 has degree 7
Node 7 has degree 8
Node 8 has degree 5
Node 9 has degree 6
Node 10 has degree 11
Node 11 has degree 3
Node 12 has degree 13
Node 13 has degree 10
Node 14 has degree 7
Node 15 has degree 13
Node 16 has degree 11
Node 17 has degree 8
Node 18 has degree 13
Node 19 has degree 12
</pre></div>
</div>
</div>
</div>
<p>Now that we know how to compute the degree of each node we can visualise the network adding colors to the nodes to represent their degree, ie. blue being low degree and red high degree. We will also display the degree of each node as a number (rather than the node index as we before) and make the size of each node proportional to its degree.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">n_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()])</span> <span class="c1">#  color nodes based on their degree</span>
<span class="n">nodes_size</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">n_color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">cool</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()),</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">nodes_size</span><span class="p">);</span>
<span class="c1"># plt.colorbar(plt.cm.ScalarMappable(cmap=plt.cm.coolwarm, norm=plt.Normalize(vmin = n_color.min(), vmax=n_color.max())))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/db1740e7a5354f66b5a9ca25c82f66fe1194d6723d55660b544c970d1d90a1b7.png" src="../../_images/db1740e7a5354f66b5a9ca25c82f66fe1194d6723d55660b544c970d1d90a1b7.png" />
</div>
</div>
<p>Now that we know the degree of each node we can compute the <strong>degree distribution</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create sorted list of the degree of each of the nodes</span>
<span class="n">degree_sequence</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">d</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create an histogram </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
<span class="n">_bins_</span> <span class="o">=</span> <span class="p">[</span><span class="n">bin_value</span> <span class="k">for</span> <span class="n">bin_value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">())[:,</span><span class="mi">1</span><span class="p">])),</span> <span class="nb">max</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">())[:,</span><span class="mi">1</span><span class="p">])))]</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">degree_sequence</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">_bins_</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Degree $k$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;P(k)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/47045194109f09759959e7dcd06c43917fcf7320e74f202324737761f6c7a52e.png" src="../../_images/47045194109f09759959e7dcd06c43917fcf7320e74f202324737761f6c7a52e.png" />
</div>
</div>
<p>Let’s also compute the other quantities we have introduced:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of nodes: </span><span class="si">{</span><span class="n">G</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of edges: </span><span class="si">{</span><span class="n">G</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Network diameter: </span><span class="si">{</span><span class="n">nx</span><span class="o">.</span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Average shortest path: </span><span class="si">{</span><span class="n">nx</span><span class="o">.</span><span class="n">average_shortest_path_length</span><span class="p">(</span><span class="n">G</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Graph with 20 nodes and 93 edges
Number of nodes: 20
Number of edges: 93
Network diameter: 3
Average shortest path: 1.5157894736842106
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4><span class="section-number">1.4.3.1. </span>Exercises 🧑‍💻🔨<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Use NetworkX <code class="docutils literal notranslate"><span class="pre">nx.gnp_random_graph(networkSize,</span> <span class="pre">p)</span></code> to create a random graph with different probability p and sizes and compute its degree distribution. Can you figure out the relation between the probability p and the shape of the degree distribution histogram?</p></li>
<li><p>Make a figure where you plot the average shortest path as a function of the network size for undirected networks of sizes from 10 to 200. #Hint: create a loop generating a random network at iteration by generating random adjacency matrix with <code class="docutils literal notranslate"><span class="pre">np.random.randint(low=0,</span> <span class="pre">high=2,</span> <span class="pre">size=(networkSize,</span> <span class="pre">networkSize))</span></code>, compute its average shortest path. Is the result surprising?</p></li>
<li><p>Now compute the same curve but for directed graphs and add them both together in the same figure. Explain why we observe different results for directed and undirected graphs.</p></li>
</ul>
</section>
</section>
<section id="clustering-coefficient">
<h3><span class="section-number">1.4.4. </span>Clustering coefficient<a class="headerlink" href="#clustering-coefficient" title="Link to this heading">#</a></h3>
<p>The clustering coefficient (CC) —or cliquishness— of node represents the fraction of interconnections between neighbors of node i. It’s a measure of how much nodes in the network tend to cluster together. Eg. In a social graph it measures the proportion of your friends that are also friends with each other. The global CC of network is simply the average of the CC of all the nodes.</p>
<div align="center">
<p style="text-align:center;"><img src="https://github.com/BergLab/CompNeuroCourse/blob/main/notebooks/network_theory/media/cc.png?raw=True" width="500"/>
<!-- <p style="text-align:center;"><img src="../network_theory/media/cc.png" width="500"/> -->
</div>
<p>A large clustering coefficient (CC) indicates large locality in the sense that neighbors of a given node tend to be directly connected while if a node has low CC it means that its neighbors aren’t connected to each other, eg. high CC is a society where nearly everybody has common friends while low CC: people have friends but these friends don’t tend to know each other.</p>
</section>
<section id="cliques">
<h3><span class="section-number">1.4.5. </span>Cliques<a class="headerlink" href="#cliques" title="Link to this heading">#</a></h3>
<p>A clique is set of nodes which are are all adjacent, that is, there is a direct connection between all pairs of them. You can think of a clique in a social network as a cohesive group of people that are tightly connected to each other. We can define 3-cliques, 4-cliques, etc. You can think of cliques as sub-networks of networks, eg. group of friend who they all know each others, while connections to other cliques represent people who have friends in several groups.</p>
<p>The graph below has:</p>
<ul class="simple">
<li><p>23 × 1-vertex cliques (the vertices),</p></li>
<li><p>42 × 2-vertex cliques (the edges),</p></li>
<li><p>19 × 3-vertex cliques (light and dark blue triangles), and</p></li>
<li><p>2 × 4-vertex cliques (dark blue areas).</p></li>
</ul>
<div align="center">
<p style="text-align:center;"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/VR_complex.svg/820px-VR_complex.svg.png" width="400"/>
</div>
<p>The 11 light blue triangles form maximal cliques. The two dark blue 4-cliques are both maximum and maximal, and the clique number of the graph is 4.</p>
</section>
<section id="motifs-and-motifs-analysis">
<h3><span class="section-number">1.4.6. </span>Motifs and motifs analysis<a class="headerlink" href="#motifs-and-motifs-analysis" title="Link to this heading">#</a></h3>
<p>Motifs are sub-graphs present in a network that are responsible for the functions of a network. Some motifs —like positive and negative feedback— are found across networks describing many phenomena. However, much more complex motifs exist. When networks are small we can try to understand the motifs present, however, when network are too big to be understood directly, we can do a <strong>motif network analysis</strong>: we create a set of random networks and compare the distribution of motifs present  in the real network vs the random ones.</p>
<div align="center">
<p style="text-align:center;"><img src="https://github.com/BergLab/CompNeuroCourse/blob/main/notebooks/network_theory/media/motifs.png?raw=True" width="500"/>
</div><p>We can easily compute the clustering coefficient of a graph with NetworkX:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">networkSize</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># probability of for a node to be connected to any other node, eg. p=1 all nodes would be connected to each other and p=0 there would not be any edge</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">gnp_random_graph</span><span class="p">(</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="c1"># gnp_random_graph function generates a random graph</span>

<span class="n">CC</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">clustering</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">CC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: 0.4,
 1: 0.5277777777777778,
 2: 0.46153846153846156,
 3: 0.4444444444444444,
 4: 0.44871794871794873,
 5: 0.4666666666666667,
 6: 0.4230769230769231,
 7: 0.5,
 8: 0.4666666666666667,
 9: 0.3333333333333333,
 10: 0.45454545454545453,
 11: 0.4642857142857143,
 12: 0.6,
 13: 0.4666666666666667,
 14: 0.35714285714285715,
 15: 0.4444444444444444,
 16: 0.5,
 17: 0.4642857142857143,
 18: 0.45454545454545453,
 19: 0.4666666666666667}
</pre></div>
</div>
</div>
</div>
<p>Notice, that this is the clustering coefficient of each node. If we want to find the global CC, we can simply compute the average:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">global_CC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">CC</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span> <span class="c1"># We select the values from the dictionary with .values(), then convert them to a list with list() and compute its mean with np.mean()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The global CC of the network is </span><span class="si">{</span><span class="n">global_CC</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The global CC of the network is 0.4572402597402598
</pre></div>
</div>
</div>
</div>
<section id="exercise">
<h4><span class="section-number">1.4.6.1. </span>Exercise 🧑‍💻🔨<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Why do you think we found the value we found for the global clustering coefficient? How would you produce a network with a different global CC? Test empirically your conjectured solution by generating a network and computing its global CC.</p></li>
</ul>
</section>
</section>
<section id="scale-free-networks">
<h3><span class="section-number">1.4.7. </span>Scale free networks<a class="headerlink" href="#scale-free-networks" title="Link to this heading">#</a></h3>
<p>Intuitively, a network is said to be scale-free if we zoom it to a subpart of the network it will look the same as if we zoom out. We can formalize this intuition by noting that the degree distribution <span class="math notranslate nohighlight">\(P(k)\)</span> of a scale-free network follows a power law: <span class="math notranslate nohighlight">\(P(k) \propto k^{-\gamma}\)</span>, where typically <span class="math notranslate nohighlight">\(\gamma \in [2,3]\)</span> . That is, we compute the dree of each node, create an histogram and look at the resulting distribution it will be thick-tailed (ie. decays slower than exponential).</p>
<div align="center">
<p style="text-align:center;"><img src="https://github.com/BergLab/CompNeuroCourse/blob/main/notebooks/network_theory/media/scale-free.png?raw=True" width="500"/>
</div></section>
<section id="small-world-networks">
<h3><span class="section-number">1.4.8. </span>Small-world networks<a class="headerlink" href="#small-world-networks" title="Link to this heading">#</a></h3>
<p>A network is defined as having <a class="reference external" href="https://www.nature.com/articles/30918">small world property</a>, when it is having a relatively large clustering coefficient, while still having a small diameter, mathematically this means that the mean shortest path <span class="math notranslate nohighlight">\(\mathcal{l}\)</span> between two nodes grows logarithmically with the size <span class="math notranslate nohighlight">\(N\)</span> of the network: <span class="math notranslate nohighlight">\(\mathcal{l} \propto log(N)\)</span>.  Many real world networks are found to have this combination of global accessibility (because of small diameter) and a strong localness (because of high clustering coefficient).</p>
<br>
<br>
<div align="center">
<p style="text-align:center;"><img src="https://media.springernature.com/full/springer-static/image/art%3A10.1038%2F30918/MediaObjects/41586_1998_Article_BF30918_Fig1_HTML.gif?as=webp" width="500"/>
</div>
<p>Both Scale-free and small-world networks are of interest to neuroscience because they are conjectured to carry similarities to networks found in the the brain.</p>
<section id="bonus-evaluating-the-small-worldness-of-a-network-g">
<h4><span class="section-number">1.4.8.1. </span>Bonus: Evaluating the small-worldness of a network G<a class="headerlink" href="#bonus-evaluating-the-small-worldness-of-a-network-g" title="Link to this heading">#</a></h4>
<p>Two quantities are used to characterize small-world netowrks: <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span>. <span class="math notranslate nohighlight">\(\sigma\)</span> is the small-worldness coefficient.
<span class="math notranslate nohighlight">\(\sigma = \frac{C/C_{r}}{L/L_{r}}\)</span> where <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(L\)</span> are respectively the average clustering coefficient and average shortest path length of the network. <span class="math notranslate nohighlight">\(C_{r}\)</span> and <span class="math notranslate nohighlight">\(L_{r}\)</span> are respectively the average clustering coefficient and average shortest path length of an equivalent random graph. A graph is commonly classified as small-world if <span class="math notranslate nohighlight">\(\sigma&gt;1\)</span>.</p>
<p>The other way of quantifying small-worldness is to compare how much the graph topology rassambles a random network, that can be quantify with <span class="math notranslate nohighlight">\(\omega = \frac{L_{r}}{L} - \frac{C}{C_{l}}\)</span> where C and L are respectively the average clustering coefficient and average shortest path length of G. <span class="math notranslate nohighlight">\(L_{r}\)</span> is the average shortest path length of an equivalent random graph and <span class="math notranslate nohighlight">\(C_{l}\)</span> is the average clustering coefficient of an equivalent lattice graph. Negative values of <span class="math notranslate nohighlight">\(\omega\)</span> mean G is similar to a lattice whereas positive values mean G is a random graph. Values close to 0 mean that G has small-world characteristics.</p>
<p>Let’s create a scale free network using NetworkX <code class="docutils literal notranslate"><span class="pre">nx.scale_free_graph()</span></code> and compute it’s degree distribution histogram to verify that if follows a power law distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">networkSize</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">scale_free_graph</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">networkSize</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
<span class="n">n_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">()])</span> <span class="c1">#  color nodes based on their degree</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">n_color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()),</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>


<span class="c1"># Create sorted list of the degree of each of the nodes</span>
<span class="n">degree_sequence</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="n">d</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()),</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create an histogram </span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">degree_sequence</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Degree $k$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;P(k)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">);</span>
<span class="c1"># plt.yscale(&#39;log&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fbcc553b8cc7df6873192b061925507d3fc809b4d495627a7e6021179d2f55c9.png" src="../../_images/fbcc553b8cc7df6873192b061925507d3fc809b4d495627a7e6021179d2f55c9.png" />
<img alt="../../_images/7f6cf43bc0828fae312595565191e2109a722e59b5a0bc4c5a37719519e165ad.png" src="../../_images/7f6cf43bc0828fae312595565191e2109a722e59b5a0bc4c5a37719519e165ad.png" />
</div>
</div>
<p>NetowrkX also allows us to generate small-world networks:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">networkSize</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">smallWorldNet</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">watts_strogatz_graph</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">));</span>
<span class="n">n_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">smallWorldNet</span><span class="o">.</span><span class="n">degree</span><span class="p">()[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">smallWorldNet</span><span class="o">.</span><span class="n">nodes</span><span class="p">()])</span> <span class="c1">#  color nodes based on their degree</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx</span><span class="p">(</span><span class="n">smallWorldNet</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="n">n_color</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">smallWorldNet</span><span class="o">.</span><span class="n">degree</span><span class="p">()),</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/29fa6fcf3fffb142a134f3e8fffbf1488f1062647ca21b053090f6848b603f64.png" src="../../_images/29fa6fcf3fffb142a134f3e8fffbf1488f1062647ca21b053090f6848b603f64.png" />
</div>
</div>
<p>Bonus: <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span> are two quantities used to charectise small world networks. Let’s compare their values for a random and small world network.</p>
<p>⚠️ The cell below will take some time to run for big networks ⚠️</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">omega</span><span class="p">(</span><span class="n">smallWorldNet</span><span class="p">)</span>
<span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Omega of the network is </span><span class="si">{</span><span class="n">omega</span><span class="si">}</span><span class="s1"> and it took </span><span class="si">{</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="si">}</span><span class="s1"> seconds to compute it&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Omega of the network is -0.28898137138327384 and it took 3.7154130935668945 seconds to compute it
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">sigma</span><span class="p">(</span><span class="n">smallWorldNet</span><span class="p">)</span>
<span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sigma of the network is </span><span class="si">{</span><span class="n">omega</span><span class="si">}</span><span class="s1"> and it took </span><span class="si">{</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="si">}</span><span class="s1"> seconds to compute it&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sigma of the network is 5.177313542990693 and it took 35.880818128585815 seconds to compute it
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">omega</span><span class="p">(</span><span class="n">smallWorldNet</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">sigma</span><span class="p">(</span><span class="n">smallWorldNet</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Omega: </span><span class="si">{</span><span class="n">omega</span><span class="si">}</span><span class="s1">, Sigma: </span><span class="si">{</span><span class="n">sigma</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Omega: -0.28646452635751085, Sigma: 5.636842931819713
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h4><span class="section-number">1.4.8.2. </span>Exercise 🧑‍💻🔨<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Compute the diameter, the average shortest path and the global CC for a small-worlds network and a scale free one (of the same size) and compare them. Discuss the difference and make you understand what why these quantities are different for those two network topologies.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Your code here</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="propagation-or-replication-in-a-network">
<h3><span class="section-number">1.4.9. </span>Propagation -or replication- in a network<a class="headerlink" href="#propagation-or-replication-in-a-network" title="Link to this heading">#</a></h3>
<p>Similarly to how we implemented the SIR Model for Spread of Disease in week 1 by using a matrix to describe the evolution of a viral infection, the adjacency matrix can be used to model <strong>propagation -or replication-</strong> in the network -like a viral infection or information propagation- where we model the state of infection of the people by a state vector <span class="math notranslate nohighlight">\(s\)</span> —a vector made of the state of each node: 0 if healthy, 1 if infected— and each propagation step of the virus can be seen as applying the adjacency matrix <span class="math notranslate nohighlight">\(M\)</span> to <span class="math notranslate nohighlight">\(s\)</span>: <span class="math notranslate nohighlight">\(s(t+1) = M s(t)\)</span>.</p>
<p>If the diagonal is zero, it means that whichever thing is transmitted is not preserved by the node, eg. money transmission. For virus transmission for example, diagonal would be one because the virus stays in the person (at least for some time).</p>
<p>An useful quantity to describe a propagation phenomena in a network —virus, money, information,..— is the <strong>amplification factor</strong> <span class="math notranslate nohighlight">\(A\)</span>. If a virus in a node spread to all the adjacent nodes of that node, then the amplification —Assuming transmission between all nodes is bidirectional (undirected network)— is: <span class="math notranslate nohighlight">\(A = \frac{&lt;k^{2}&gt;}{&lt;k&gt;} -1\)</span> where <k> is the average degree of connectivity.</p>
<ul class="simple">
<li><p>When A &gt; 1 then “disease like” signals tends to be exponentially amplified, and therefore will spread across the entire network, this of course reflects a high connectivity of the network.</p></li>
<li><p>For A = 1, on the other hand, perturbations will be marginal spreading, where some will spread and others will “die-out”. In this case we need to have an average of 1 output per 1 input. This case will lead to a power law distribution of clusters size.</p></li>
</ul>
<p>A can also be used to estimate the <strong>robustness</strong> of the overall connectedness of the network against removal of a fraction f of its nodes, and hence evaluate the robustness of the network (defined as the resistance against the removal of a fraction of its nodes while preserving the propagation process it does, eg. viral propagation). This is useful therefore to know for example how many people we need to vaccinate to stop an epidemic or to build robust transportation or communication networks.</p>
</section>
<section id="diffusion-in-a-network">
<h3><span class="section-number">1.4.10. </span>Diffusion in a network<a class="headerlink" href="#diffusion-in-a-network" title="Link to this heading">#</a></h3>
<p>If we take the adjacency matrix and replace its non-zero values by a weight representing the strength of the connection we obtain the <strong>transfer matrix</strong> <span class="math notranslate nohighlight">\(T\)</span> (provided that the sum of weights for each node is equal to 1). The transfer matrix describe a diffusion process in a network. In a diffusion process we observed a continuous propagation of a given quantity —as opposed to the binary propagation in replication.</p>
<p>The eigenvalues of the transfer matrix gives information about how fast the diffusion process expand/contract.</p>
</section>
<section id="spectral-graph-theory">
<h3><span class="section-number">1.4.11. </span>Spectral graph theory<a class="headerlink" href="#spectral-graph-theory" title="Link to this heading">#</a></h3>
<p>As it is always the case when working with matrices, we can derive certain network properties from the connectivity matrix eigenspectrum, this is referred as <a class="reference external" href="https://en.wikipedia.org/wiki/Spectral_graph_theory">Spectral graph theory</a>. We won’t elaborate more on this but let us show that it is straightforward to compute the eigenvalues of a graph using NetworkX and numpy:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy.linalg</span>

<span class="n">networkSize</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">numberOfEdges</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">gnm_random_graph</span><span class="p">(</span><span class="n">networkSize</span><span class="p">,</span> <span class="n">numberOfEdges</span><span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">normalized_laplacian_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Largest eigenvalue:&quot;</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Smallest eigenvalue:&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eigenvalue&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/anaconda3/lib/python3.11/site-packages/scipy/sparse/_base.py:719: VisibleDeprecationWarning: `.A` is deprecated and will be removed in v1.13.0. Use `.toarray()` instead.
  warn(np.VisibleDeprecationWarning(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Largest eigenvalue: 1.427040196570421
Smallest eigenvalue: 1.7493315605580453e-17
</pre></div>
</div>
<img alt="../../_images/7c65d0a76d7c3162f5d94257de842a803980b2a21b3fe11b52f76786a1a1d97a.png" src="../../_images/7c65d0a76d7c3162f5d94257de842a803980b2a21b3fe11b52f76786a1a1d97a.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/network_theory"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../ML/b.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Machine Learning</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-networks">1.1. Why networks?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-network-concepts">1.2. Basic network concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nodes-and-edges">1.2.1. Nodes and edges</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#network-connectivity">1.2.2. Network Connectivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#connected-network">1.2.3. Connected Network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#directed-vs-undirected-network">1.2.4. Directed vs undirected network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphs-with-features">1.2.5. Graphs with features</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#features-normalisation">1.2.5.1. Features normalisation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-activation">1.2.5.2. Feature activation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-linear-transformations">1.2.5.3. Extra Linear transformations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-networkx">1.3. Using NetworkX</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">1.3.1. Exercises 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#measures-used-to-characterise-networks">1.4. Measures used to characterise networks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degree-of-connectivity">1.4.1. Degree of connectivity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-diameter-and-shortest-path">1.4.2. Distance, diameter and shortest path</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#centrality">1.4.3. Centrality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">1.4.3.1. Exercises 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustering-coefficient">1.4.4. Clustering coefficient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cliques">1.4.5. Cliques</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motifs-and-motifs-analysis">1.4.6. Motifs and motifs analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">1.4.6.1. Exercise 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scale-free-networks">1.4.7. Scale free networks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#small-world-networks">1.4.8. Small-world networks</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-evaluating-the-small-worldness-of-a-network-g">1.4.8.1. Bonus: Evaluating the small-worldness of a network G</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">1.4.8.2. Exercise 🧑‍💻🔨</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#propagation-or-replication-in-a-network">1.4.9. Propagation -or replication- in a network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-in-a-network">1.4.10. Diffusion in a network</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-graph-theory">1.4.11. Spectral graph theory</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Elias Najarro & Rune Berg
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>